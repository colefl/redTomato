@page "/popup.html"
@inherits BasePage

<body>
    <h1 style="width:600px">hi there I'm of a larger width</h1>
    <Slider Min="0" Max="100" @bind-Value="sliderValue"/>
    
        <div>
            <!---<input bind-value="InputValue" @bind-value:event="OnInput" Placeholder="Please enter a time"/> --->
            <p>Time: @timeSpan.ToString() </p>
            <input value="@Value" @oninput="ValueChanged"/>
        </div>

    <button @onClick="StartTimer">Start</button>
    <button @onClick="StopTimer">Stop</button>
    <button @onClick="ResetTimer">Reset</button>

</body>

@code {

    [Parameter]
   public string Value { get; set; }

   [Parameter]
   public EventCallback<ChangeEventArgs> ValueChanged { get; set; }


    private int sliderValue = 50;
    private TimeSpan timeSpan;
    private DateTime startTime;
    private Timer timer;
    private bool isRunning = false;

    private void StartTimer(){
        if(!isRunning){
            startTime = DateTime.Now; //The time is now
            timer = new Timer(UpdateTime, null, 0, 1000);
            isRunning = true;
            Console.WriteLine(isRunning);
        }
    }

    private void StopTimer(){
        if(isRunning){
            timer?.Dispose();
            isRunning = false;
        }
    }

    private void ResetTimer(){
        StopTimer();
        timeSpan = TimeSpan.Zero;
    }

    private void UpdateTime(object state){
        timeSpan = DateTime.Now - startTime;
        InvokeAsync(StateHasChanged);
    }
}
